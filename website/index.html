<!DOCTYPE html>
<html lang="en">

<head>
		<link rel="stylesheet" type="text/css" href="style.css">
		<link rel="stylesheet" href="animate.css">
		<link href="https://fonts.googleapis.com/css?family=Monoton|Orbitron&display=swap" rel="stylesheet">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<header>
	<div class='wow bounceInRight'>
		<h1 class='neon' data-text="There Will Be Dogs">There Will Be Dogs</h1>
	</div>
		<h2 class="neon-body" data-text="Have our robot guess your dog's breed!">Have our robot guess your dog's breed!</h2>
</header>
<body>
		<div class="wow bounceInLeft">
			<img class='animated-gif' src="gif.gif" alt=”animated” />
		</div>
		<div class="flier" id="label"></div>
		<h3>
			<div class="instructions">
				Upload an image of your pupper and our robot technology will guess which breed your dog looks most similar too!
			</div>
		</h3>




		<input id="image-selector" type="file" size=".1"></input>
		<button id="predict-button">Predict</button>
		<img class='upimg' id="selected-image" src=""/>
		<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script>
        let base64Image;
				let extension;
        $("#image-selector").change(function() {
          let reader = new FileReader();
          reader.onload = function(e) {
                let dataURL = reader.result;
                $('#selected-image').attr("src", dataURL);
								extension = dataURL.split(';base64,')[0].split('/')[1];
                base64Image = dataURL.replace(/data:image\/(png|jpg|jpeg|JPG|JPEG|);base64,/,"");
            }
          reader.readAsDataURL($("#image-selector")[0].files[0]);
        });
        $("#predict-button").click(function(event){
          let message = {
                image: base64Image,
								type: extension
            };
          $.post("http://165.227.88.103:5000/predict", JSON.stringify(message),
						function(response){
							var outputImg = document.createElement('img');
							outputImg.setAttribute("class", "downimg");
							outputImg.setAttribute("id", "predimg");
							outputImg.src = response.prediction;
							document.body.appendChild(outputImg);
							if (response.label=="NOT DOG"){
								$("#label").text(response.label);
							} else {
								$.post("http://165.227.88.103:8181/predict", JSON.stringify(message),
									function(response){
										$("#label").text(response.breed);
									});
							};
            });
        });

    </script>
		<script src="js/wow.min.js"></script>
		<script>
 		new WOW().init();
		</script>

</body>

</html>
